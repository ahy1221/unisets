---
title: >
  An introduction to the `r Githubpkg("uniset")` interface 
author:
- name: Kevin Rue-Albrecht
  affiliation: 
  - &id4 Kennedy Institute of Rheumatology, University of Oxford,
    Headington, Oxford OX3 7FY, UK.
  email: kevin.rue-albrecht@kennedy.ox.ac.uk
- name: Second Author
  affiliation: Second Author's Affiliation
  email: corresponding@author.com
date: "`r BiocStyle::doc_date()`"
package: "`r BiocStyle::pkg_ver('uniset')`"
output: 
  BiocStyle::html_document:
    toc_float: true
abstract: |
  Introduction to the `uniset` package.
vignette: |
  %\VignetteIndexEntry{1. Introduction to uniset}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}  
  %\VignettePackage{uniset}
---

# Installation

You can install the released version of uniset from [GitHub](https://github.com/kevinrue/uniset) with:

```{r, eval=FALSE}
devtools::install_github("kevinrue/uniset")
```

# Getting started

## The BaseSet class

This is a basic example which shows you how to create a `BaseSet` object, to store simple associations between genes and sets:

```{r, message=FALSE}
library(uniset)
gene_lists <- list(
    geneset1 = c("A", "B"),
    geneset2 = c("B", "C", "D")
)
mapping_table <- DataFrame(
    element = unlist(gene_lists),
    set     = rep(names(gene_lists), lengths(gene_lists))
)
base_set <- BaseSet(mapping_table)
base_set
```

Metadata for each element and set can be provided as `DataFrame` objects:

```{r, message=FALSE}
gene_data <- DataFrame(
    row.names = c("A", "B", "C", "D"),
    stat1     = c( 1,   2,   3,   4 ),
    info1     = c("a", "b", "c", "d")
)
set_data <- DataFrame(
    row.names = c("geneset1", "geneset2"),
    stat1     = c(      100,        200 ),
    info1     = c(     "abc",      "def")
)
base_set <- BaseSet(mapping_table, gene_data, set_data)
base_set
```

## The FuzzySet class

More sophisticated classes are available to store additional information (e.g. `FuzzySet`).

```{r, message=FALSE}
membership <- runif(nrow(mapping_table))
fuzzy_set <- FuzzySet(mapping_table, gene_data, set_data, membership=membership)
fuzzy_set
```

# Subsetting

The `subset` method can be applied to a `BaseSet` object, using a logical expression referring to the `"element"` and `"set"` columns, and indicating rows to keep.

```{r}
subset(base_set, element %in% c("B", "C") | set == "geneset1")
```

Similarly, the `subset` method can be also applied to a `FuzzySet` object, where the logical expression may also refer to the `"membership"` slot.

```{r}
subset(fuzzy_set, set == "geneset2" & membership > 0.3)
```

# Converting to list

It is possible to extract the gene sets as a `list`, for use with functions such as `lapply`.

```{r}
as.list(base_set)
```

# Additional information

The size of each gene set can be obtained using the `setLengths` method.

```{r}
setLengths(fuzzy_set)
```

Conversely, the number of sets associated with each gene is returned by the `elementLengths` function.

```{r}
elementLengths(fuzzy_set)
```

# Session info {.unnumbered}

```{r sessionInfo, echo=FALSE}
sessionInfo()
```
